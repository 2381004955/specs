<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZigZag Commitments | Filecoin Spec</title>



<link rel="stylesheet" href="../../../../book.min.8ad7369f48c202f33a561c4392159cab5b8b2dbd7ccdab4f731410d11b10c7a9.css">
<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=EB+Garamond" />


<link rel="icon" href="../../../../favicon.png" type="image/x-icon">


<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  <link rel="stylesheet" href="../../../../css/syntax.css">
<link href="../../../../mermaid/mermaid.css" type="text/css" rel="stylesheet" />
<script src="../../../../mermaid/mermaid.js"></script>
<script src="../../../../spec.js"></script>

</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href=""><span>Filecoin Spec</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" placeholder="Search" id="book-search-input" maxlength="64" readonly />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





    
  
  
  

  <style>
  nav ul a[href$="\2f docs\2f algorithms\2fzigzag_commitments\2fzigzag_commitments\2f "] {
      color: #0b3a53;
  }
  </style>


  <div>

  <div>
    
    <input id="menu-detail-slider" type="range" onchange="onMenuDetailChange();"
      min="1" value="3" max="5" step="1" />

    <span id="menu-detail-slider-label">3</span>
  </div>

  
  
  <ul class="menu-item-section depth-0">
  
      <li>
      
        











<a href="../../../../#intro" class="menu-item depth-1">
    
    
    <strong>
    
        Introduction
    
    </strong>
    
</a>



<ul class="menu-item-section depth-1">

    <li>
    
      











<a href="../../../../#intro__arch" class="menu-item depth-2">
    
    
        Architecture Diagrams
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#intro__concepts" class="menu-item depth-2">
    
    
        Key Concepts
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#intro__filecoin_vm" class="menu-item depth-2">
    
    
        Filecoin VM
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#intro__process" class="menu-item depth-2">
    
    
        Process
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      










  


<a href="../../../../#intro__process__about" class="menu-item depth-3">
    
    
        About
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#intro__process__fip" class="menu-item depth-3">
    
    
        FIPs
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#intro__process__contributing" class="menu-item depth-3">
    
    
        Contributing
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#intro__process__related_resources" class="menu-item depth-3">
    
    
        Related Resources
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#intro__process__related_resources__research_portal" class="menu-item depth-4">
    
    
        Research portal
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#intro__process__related_resources__network_tooling" class="menu-item depth-4">
    
    
        Network tooling
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#intro__process__related_resources__testing" class="menu-item depth-4">
    
    
        Testing and implementation compliance
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#intro__system" class="menu-item depth-2">
    
    
        System Decomposition
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      










  


<a href="../../../../#intro__system__why_systems" class="menu-item depth-3">
    
    
        What are Systems?
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#intro__system__impl_systems" class="menu-item depth-3">
    
    
        Implementing Systems
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

</ul>


    
    </li>

</ul>


      
      </li>
  
      <li>
      
        











<a href="../../../../#systems" class="menu-item depth-1">
    
    
    <strong>
    
        Systems
    
    </strong>
    
</a>



<ul class="menu-item-section depth-1">

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes" class="menu-item depth-2">
    ‚öôÔ∏è
    
        <strong>Filecoin Nodes</strong>
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__node_types" class="menu-item depth-3">
    
    
        Node Types
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__node_types__node" class="menu-item depth-4">
    
    
        Node Interface
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__node_types__node_types" class="menu-item depth-4">
    
    
        Examples
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__node_types__verifier_node" class="menu-item depth-4">
    
    
        Chain Verifier Node
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__node_types__client_node" class="menu-item depth-4">
    
    
        Client Node
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__node_types__storage_miner_node" class="menu-item depth-4">
    
    
        Storage Miner Node
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__node_types__retrieval_miner_node" class="menu-item depth-4">
    
    
        Retrieval Miner Node
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__node_types__relayer_node" class="menu-item depth-4">
    
    
        Relayer Node
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_nodes__repository" class="menu-item depth-3">
    
    
        Repository
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      










  


<a href="../../../../#systems__filecoin_nodes__repository__config" class="menu-item depth-4">
    
    
        Config
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__repository__key" class="menu-item depth-4">
    
    
        KeyStore &amp; user keys
    
</a>



<ul class="menu-item-section depth-4">

    <li>
    
    </li>

    <li>
    
    </li>

    <li>
    
    </li>

    <li>
    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_nodes__repository__ipldstore" class="menu-item depth-4">
    
    
        IpldStore
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__repository__usage" class="menu-item depth-4">
    
    
        Usage in Systems
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__network" class="menu-item depth-3">
    
    
        Network Interface
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_nodes__clock" class="menu-item depth-3">
    
    
        Clock
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_files" class="menu-item depth-2">
    üìë
    
        <strong>Files &amp; Data</strong>
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      











<a href="../../../../#systems__filecoin_files__file" class="menu-item depth-3">
    
    
        File
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      










  


<a href="../../../../#systems__filecoin_files__file__filestore" class="menu-item depth-4">
    
    
        FileStore
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_files__piece" class="menu-item depth-3">
    
    
        Piece
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      










  


<a href="../../../../#systems__filecoin_files__piece__piece_store" class="menu-item depth-4">
    
    
        PieceStore
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_files__data_transfer" class="menu-item depth-3">
    
    
        Data Transfer
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain" class="menu-item depth-2">
    üì¶
    
        <strong>Blockchain</strong>
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      










  


<a href="../../../../#systems__filecoin_blockchain__vm" class="menu-item depth-3">
    
    
        Virtual Machine
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__vm__address" class="menu-item depth-4">
    
    
        VM Address
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_blockchain__vm__actor" class="menu-item depth-4">
    
    
        VM Actor
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__vm__state_tree" class="menu-item depth-4">
    
    
        VM State Tree
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_blockchain__vm__message" class="menu-item depth-4">
    
    
        VM Message
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__vm__sysactors" class="menu-item depth-4">
    
    
        VM System Actors
    
</a>



<ul class="menu-item-section depth-4">

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__vm__sysactors__init_actor" class="menu-item depth-5">
    
    
        InitActor
    
</a>



<ul class="menu-item-section depth-5">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__vm__sysactors__cron_actor" class="menu-item depth-5">
    
    
        CronActor
    
</a>



<ul class="menu-item-section depth-5">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__vm__sysactors__account_actor" class="menu-item depth-5">
    
    
        AccountActor
    
</a>



<ul class="menu-item-section depth-5">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_blockchain__vm__interpreter" class="menu-item depth-4">
    
    
        VM Interpreter
    
</a>



<ul class="menu-item-section depth-4">

    <li>
    
    </li>

    <li>
    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_blockchain__vm__runtime" class="menu-item depth-4">
    
    
        VM Runtime Environment
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__message_pool" class="menu-item depth-3">
    
    
        Message Pool
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__message_pool__message_syncer" class="menu-item depth-4">
    
    
        Message Syncer
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__message_pool__message_storage" class="menu-item depth-4">
    
    
        Message Storage
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__blockchain" class="menu-item depth-3">
    
    
        Blockchain Components
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__blockchain__block_syncer" class="menu-item depth-4">
    
    
        Block Syncer
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__blockchain__chain_manager" class="menu-item depth-4">
    
    
        Chain Manager
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__blockchain__block_producer" class="menu-item depth-4">
    
    
        Block Producer
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__storage_power_consensus" class="menu-item depth-3">
    
    
        Storage Power Consensus
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__storage_power_consensus__expected_consensus" class="menu-item depth-4">
    
    
        Expected Consensus
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_blockchain__storage_power_consensus__storage_power_actor" class="menu-item depth-4">
    
    
        Storage Power Actor
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_token" class="menu-item depth-2">
    üìÄ
    
        <strong>Token</strong>
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      










  


<a href="../../../../#systems__filecoin_token__wallets" class="menu-item depth-3">
    
    
        Wallet
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_token__payments" class="menu-item depth-3">
    
    
        Payments
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_token__payment_channels" class="menu-item depth-3">
    
    
        Payment Channels
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_token__payment_channels__payment_channel_actor" class="menu-item depth-4">
    
    
        Payment Channel Actor
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_token__multisig" class="menu-item depth-3">
    
    
        Multisig Wallet
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_token__multisig__multisig_actor" class="menu-item depth-4">
    
    
        Multisig Actor
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_mining" class="menu-item depth-2">
    ‚õè
    
        <strong>Storage Mining</strong>
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      










  


<a href="../../../../#systems__filecoin_mining__storage_mining" class="menu-item depth-3">
    
    
        Storage Miner
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__storage_mining__mining_cycle" class="menu-item depth-4">
    
    
        Storage Mining Cycle
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__storage_mining__storage_miner_actor" class="menu-item depth-4">
    
    
        Storage Miner Actor
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__storage_mining__mining_scheduler" class="menu-item depth-4">
    
    
        Mining Scheduler
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__sector" class="menu-item depth-3">
    
    
        Sector
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__sector__sectorset" class="menu-item depth-4">
    
    
        Sector Set
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__sector__sealing" class="menu-item depth-4">
    
    
        Sector Sealing
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__sector_index" class="menu-item depth-3">
    
    
        Sector Index
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
    </li>

    <li>
    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__sector_index__sector_builder" class="menu-item depth-4">
    
    
        Sector Builder
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__sector_index__sector_store" class="menu-item depth-4">
    
    
        SectorStore
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_mining__storage_proving" class="menu-item depth-3">
    
    
        Storage Proving
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      










  


<a href="../../../../#systems__filecoin_mining__storage_proving__sealer" class="menu-item depth-4">
    
    
        Sector Sealer
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_mining__storage_proving__poster" class="menu-item depth-4">
    
    
        Sector Poster
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_markets" class="menu-item depth-2">
    ‚öñÔ∏è
    
        <strong>Market</strong>
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      










  


<a href="../../../../#systems__filecoin_markets__order" class="menu-item depth-3">
    
    
        Orders
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_markets__deal" class="menu-item depth-3">
    
    
        Deals
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_markets__storage_market" class="menu-item depth-3">
    
    
        Storage Market
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_markets__storage_market__storage_market_actor" class="menu-item depth-4">
    
    
        Storage Market Actor
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_markets__storage_market__faults" class="menu-item depth-4">
    
    
        Faults
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#systems__filecoin_markets__retrieval_market" class="menu-item depth-3">
    
    
        Retrieval Market
    
</a>



<ul class="menu-item-section depth-3">

    <li>
    
      











<a href="../../../../#systems__filecoin_markets__retrieval_market__retrieval_client" class="menu-item depth-4">
    
    
        Retrieval Client
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#systems__filecoin_markets__retrieval_market__retrieval_provider" class="menu-item depth-4">
    
    
        Retrieval Provider (Miner)
    
</a>



<ul class="menu-item-section depth-4">

</ul>


    
    </li>

</ul>


    
    </li>

</ul>


    
    </li>

</ul>


      
      </li>
  
      <li>
      
        










  


<a href="../../../../#libraries" class="menu-item depth-1">
    
    
    <strong>
    
        Libraries
    
    </strong>
    
</a>



<ul class="menu-item-section depth-1">

    <li>
    
      










  


<a href="../../../../#libraries__filcrypto" class="menu-item depth-2">
    
    
        filcrypto
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      










  


<a href="../../../../#libraries__filcrypto__filproofs" class="menu-item depth-3">
    
    
        filproofs
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#libraries__fcs" class="menu-item depth-2">
    
    
        FCS
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#libraries__ipld" class="menu-item depth-2">
    
    
        IPLD
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      










  


<a href="../../../../#libraries__ipld__cid" class="menu-item depth-3">
    
    
        CID
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#libraries__ipld__datamodel" class="menu-item depth-3">
    
    
        Data Model
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#libraries__ipld__selectors" class="menu-item depth-3">
    
    
        Selectors
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#libraries__ipld__graphstore" class="menu-item depth-3">
    
    
        GraphStore
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#libraries__libp2p" class="menu-item depth-2">
    
    
        libp2p
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      










  


<a href="../../../../#libraries__libp2p__gossipsub" class="menu-item depth-3">
    
    
        gossipsub
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#libraries__libp2p__kad_dht" class="menu-item depth-3">
    
    
        kad-dht
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#libraries__libp2p__fil_libp2p_nodes" class="menu-item depth-3">
    
    
        fil-libp2p Nodes
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#libraries__ipfs" class="menu-item depth-2">
    
    
        IPFS
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      











<a href="../../../../#libraries__ipfs__bitswap" class="menu-item depth-3">
    
    
        BitSwap
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#libraries__ipfs__graphsync" class="menu-item depth-3">
    
    
        GraphSync
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#libraries__ipfs__unixfs" class="menu-item depth-3">
    
    
        UnixFS
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      










  


<a href="../../../../#libraries__multiformats" class="menu-item depth-2">
    
    
        Multiformats
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

</ul>


      
      </li>
  
      <li>
      
        











<a href="../../../../#algorithms" class="menu-item depth-1">
    
    
    <strong>
    
        Algorithms
    
    </strong>
    
</a>



<ul class="menu-item-section depth-1">

    <li>
    
      











<a href="../../../../#algorithms__expected_consensus" class="menu-item depth-2">
    
    
        Expected Consensus
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#algorithms__porep" class="menu-item depth-2">
    
    
        Proof-of-Replication
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      











<a href="../../../../#algorithms__porep__zigzag" class="menu-item depth-3">
    
    
        ZigZag-PoRep
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#algorithms__porep__porep_commitments" class="menu-item depth-3">
    
    
        PoRep Commitments
    
</a>




    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#algorithms__post" class="menu-item depth-2">
    
    
        Proof-of-Spacetime
    
</a>



<ul class="menu-item-section depth-2">

    <li>
    
      











<a href="../../../../#algorithms__post__rational_post" class="menu-item depth-3">
    
    
        Rational-PoSt
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#algorithms__post__proof_of_spacetime_parameters" class="menu-item depth-3">
    
    
        PoSt Parameters
    
</a>



<ul class="menu-item-section depth-3">

</ul>


    
    </li>

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#algorithms__payment_channels" class="menu-item depth-2">
    
    
        Payment Channels
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#algorithms__block_sync" class="menu-item depth-2">
    
    
        BlockSync
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#algorithms__gossip_sub" class="menu-item depth-2">
    
    
        GossipSub
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#algorithms__crypto" class="menu-item depth-2">
    
    
        Cryptographic Primitives
    
</a>




    
    </li>

</ul>


      
      </li>
  
      <li>
      
        











<a href="../../../../#listings" class="menu-item depth-1">
    
    
    <strong>
    
        Listings
    
    </strong>
    
</a>



<ul class="menu-item-section depth-1">

    <li>
    
      











<a href="../../../../#listings__actors" class="menu-item depth-2">
    
    
        Filecoin VM Actors
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#listings__data_structures" class="menu-item depth-2">
    
    
        Data Structures
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#listings__system_map" class="menu-item depth-2">
    
    
        Components
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#listings__libp2p_protocols" class="menu-item depth-2">
    
    
        libp2p Protocols
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

</ul>


      
      </li>
  
      <li>
      
        











<a href="../../../../#glossary" class="menu-item depth-1">
    
    
    <strong>
    
        Glossary
    
    </strong>
    
</a>



<ul class="menu-item-section depth-1">

</ul>


      
      </li>
  
      <li>
      
        











<a href="../../../../#appendix" class="menu-item depth-1">
    
    
    <strong>
    
        Appendix
    
    </strong>
    
</a>



<ul class="menu-item-section depth-1">

    <li>
    
      











<a href="../../../../#appendix__sharray" class="menu-item depth-2">
    
    
        Sharded IPLD Array
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#appendix__address" class="menu-item depth-2">
    
    
        Address
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

    <li>
    
      











<a href="../../../../#appendix__orient" class="menu-item depth-2">
    
    
        Filecoin Parameters
    
</a>



<ul class="menu-item-section depth-2">

</ul>


    
    </li>

</ul>


      
      </li>
  
  </ul>
  
</div>










</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="../../../../svg/menu.svg" alt="Menu" />
  </label>
  <strong>ZigZag Commitments</strong>
</header>

      
<article class="markdown">
  

<h2 id="introduction">Introduction</h2>

<p>This document provides a simplified visual explanation of the ZigZag Commitment algorithm described in <a href="https://www.overleaf.com/read/kcdhnxwptxbc">Tight PoS - ZigZag</a>.</p>

<p>It is intended to confer intuition about the algorithm, and to serve as a reference for implementers. The author of this
document and those of the linked paper believe the two are consistent; and converging on this consistent design was a
third design goal of this document&rsquo;s construction.</p>

<h2 id="graph">Graph</h2>

<p>Both renumbered (DRG) and reversed (expander) parents are generated by a pseudorandom permutation and are provided only
to illustrate the nature of the zigzag commitment scheme. They accurately represent how parent-child relationships
change between layers, and are accurate for expander parents. However, this is not representative of the DRG parent
selection algorithm.</p>

<p>The following graphs illustrate how the position of challenges, DRG parents, and expander parents change between
layers. Only a single DRG parent and a single expander parent are shown. The immediate predecessor parent is shown for
graph topology, but it is not tracked in the tables below.</p>

<ul>
<li>The challenged node alternates on even and odd layers.</li>
<li>The DRG parents alternate in the same way.</li>
<li>The expander parents do not alternate in this way. The edges between nodes and their expander parents are reversed between layers.</li>
</ul>

<p>In order to have a compact and concrete example, we use a graph containing only 8 nodes replicated in 6 layers.</p>

<h3 id="legend">Legend</h3>

<figure>
    <img src="../../../../ox-hugo/legend-odd.png"/> 
</figure>


<figure>
    <img src="../../../../ox-hugo/legend-even.png"/> 
</figure>


<h3 id="data-layer--comm-d--tree">Data Layer: \(Comm_D\) Tree</h3>

<figure>
    <img src="../../../../ox-hugo/data-layer.png"/> 
</figure>


<h3 id="replica-column-layers--comm-c--tree">Replica Column Layers: \(Comm_C\) Tree</h3>

<figure>
    <img src="../../../../ox-hugo/layer-0.png"/> 
</figure>


<figure>
    <img src="../../../../ox-hugo/layer-1.png"/> 
</figure>


<figure>
    <img src="../../../../ox-hugo/layer=2.png"/> 
</figure>


<figure>
    <img src="../../../../ox-hugo/layer-3.png"/> 
</figure>


<figure>
    <img src="../../../../ox-hugo/layer-4.png"/> 
</figure>


<h3 id="final-layer--comm-r-last--tree">Final Layer: \(Comm_{R_{LAST}}\) Tree</h3>

<figure>
    <img src="../../../../ox-hugo/layer-5.png"/> 
</figure>


<h2 id="commitment-algorithm">Commitment Algorithm</h2>

<h3 id="goal">Goal</h3>

<p>We will generate two commitments \(Comm_R, Comm_D\) to be placed on chain.</p>

<p>\(Comm_D\) is the merkle root of the original data.</p>

<p>\(Comm_R = H(Comm_C || Comm_{R_{LAST}})\).</p>

<p>Their construction is described below.</p>

<h3 id="definitions-and-notation">Definitions and Notation</h3>

<p>We will perform \(L\) layers of ZigZag replication over \(N\) labeled nodes. The algorithm described here assumes, for
simplicity of explanation, that \(L\) is even. This is a safe assumption given the actual parameters used by Filecoin.</p>

<p>In the running example, \(L\) is <code>6</code> and \(N\) is <code>8</code>.</p>

<p>Merkle roots (commitments) are generated with the vector-commitment function \(VC(‚Ä¶)\).</p>

<p>Hashes are produced with a hash function \(H(‚Ä¶)\), which is not necessarily that used by \(VC(‚Ä¶)\).</p>

<p>\(Comm = VC(l_1||‚Ä¶||l_N)\), where the \(l_i\) are the data (labels or hashes) to be committed.</p>

<p>Generated trees are retained until the proving phase, when merkle proofs of a given label&rsquo;s inclusion in \(Comm\) will be
created. We will designate such proofs \(l_i \rightarrow Comm\).</p>

<p>We use the notation \(e{_i}^{(l)}\), correlated in the table below with the \((l, i)\) notation used in the graphs above,
where \(l\) indexes layers, and \(i\) indexes labels or columns. Column indexes always have the property that the label of
the column&rsquo;s first/odd layer has the same index as the column itself.</p>

<p>To avoid inlining the &lsquo;renumbering&rsquo; calculation whenever indexing even layers, we use the notation \(\bar{i}\) to
represent the renumbered index, \(\bar{i} = N - i + 1\).</p>

<p>Taken together, the previous two paragraphs imply that the first layer&rsquo;s label in \(C_i\) is \(e_i^{(1)}\) and the second
layer&rsquo;s label is \(e_{\bar{i}}^{(2)}\).</p>

<p>NOTE: Whenever we refer to even/odd parents or nodes (e.g. &lsquo;odd expander parents&rsquo;), we mean those on even or odd
<em>layers</em>.</p>

<table>
<thead>
<tr>
<th>Graph</th>
<th>\((1, 1)\)</th>
<th>\((1, 2)\)</th>
<th>\((1, 3)\)</th>
<th>\((1, 4)\)</th>
<th>\((1, 5)\)</th>
<th>\((1, 6)\)</th>
<th>\((1, 7)\)</th>
<th>\((1, 8)\)</th>
</tr>
</thead>

<tbody>
<tr>
<td>Notation</td>
<td>\(e_1^{(1)}\)</td>
<td>\(e_2^{(1)}\)</td>
<td>\(e_3^{(1)}\)</td>
<td>\(e_4^{(1)}\)</td>
<td>\(e_5^{(1)}\)</td>
<td>\(e_6^{(1)}\)</td>
<td>\(e_7^{(1)}\)</td>
<td>\(e_8^{(1)}\)</td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
<th>Graph</th>
<th>\((2, 1)\)</th>
<th>\((2, 2)\)</th>
<th>\((2, 3)\)</th>
<th>\((2, 4)\)</th>
<th>\((2, 5)\)</th>
<th>\((2, 6)\)</th>
<th>\((2, 7)\)</th>
<th>\((2, 8)\)</th>
</tr>
</thead>

<tbody>
<tr>
<td>Notation</td>
<td>\(e_1^{(2)}\)</td>
<td>\(e_2^{(2)}\)</td>
<td>\(e_3^{(2)}\)</td>
<td>\(e_4^{(2)}\)</td>
<td>\(e_5^{(2)}\)</td>
<td>\(e_6^{(2)}\)</td>
<td>\(e_7^{(2)}\)</td>
<td>\(e_8^{(2)}\)</td>
</tr>
</tbody>
</table>

<p>‚Ä¶</p>

<table>
<thead>
<tr>
<th>Graph</th>
<th>\((6, 1)\)</th>
<th>\((6, 2)\)</th>
<th>\((6, 3)\)</th>
<th>\((6, 4)\)</th>
<th>\((6, 5)\)</th>
<th>\((6, 6)\)</th>
<th>\((6, 7)\)</th>
<th>\((6, 8)\)</th>
</tr>
</thead>

<tbody>
<tr>
<td>Notation</td>
<td>\(e_1^{(6)}\)</td>
<td>\(e_2^{(6)}\)</td>
<td>\(e_3^{(6)}\)</td>
<td>\(e_4^{(6)}\)</td>
<td>\(e_5^{(6)}\)</td>
<td>\(e_6^{(6)}\)</td>
<td>\(e_7^{(6)}\)</td>
<td>\(e_8^{(6)}\)</td>
</tr>
</tbody>
</table>

<h3 id="initial-data-layer">Initial Data Layer</h3>

<table>
<thead>
<tr>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th>(Odd) Challenge</th>
<th><code>~~~~</code></th>
</tr>
</thead>

<tbody>
<tr>
<td>\((0, 1)\)</td>
<td>\((0, 2)\)</td>
<td>\((0, 3)\)</td>
<td>\((0, 4)\)</td>
<td>\((0, 5)\)</td>
<td>\((0, 6)\)</td>
<td>\((0, 7)\)</td>
<td>\((0, 8)\)</td>
</tr>
</tbody>
</table>

<ul>
<li><p>Vector Commitment</p>

<p>Generate Merkle root for data leaves.</p>

<p>\(Comm_D = VC(D_1 || D_2 || ‚Ä¶ || D_N)\), where \(D_i = e_i^{(0)}\).</p>

<p>This example: \(Comm_D = VC(e_1^{(0)}, e_2^{(0)}, e_3^{(0)}, e_4^{(0)}, e_5^{(0)}, e_6^{(0)}, e_7^{(0)}, e_8^{(0)})\).</p></li>

<li><p>Opening</p>

<p>To open \(D_i\), provide a merkle proof \(D_i \rightarrow Comm_D\).</p></li>
</ul>

<h3 id="zigzag-replica-columns">ZigZag Replica Columns</h3>

<ul>
<li><p>Unpartitioned Columns</p>

<table>
<thead>
<tr>
<th>Even Expander Parents</th>
<th><code>~~~~</code></th>
<th>DRG Parents</th>
<th>Odd Expander Parents</th>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th>Challenges</th>
<th><code>~~~~</code></th>
</tr>
</thead>

<tbody>
<tr>
<td>\((1, 1)^{*}\)</td>
<td>\((1, 2)\)</td>
<td>\((1, 3)\)</td>
<td>\((1, 4)^{*}\)</td>
<td>\((1, 5)\)</td>
<td>\((1, 6)\)</td>
<td>\((1, 7)\)</td>
<td>\((1, 8)\)</td>
</tr>

<tr>
<td>\((2, 8)\)</td>
<td>\((2, 7)\)</td>
<td>\((2, 6)\)</td>
<td>\((2, 5)^{*}\)</td>
<td>\((2, 4)\)</td>
<td>\((2, 3)\)</td>
<td>\((2, 2)\)</td>
<td>\((2, 1)\)</td>
</tr>

<tr>
<td>\((3, 1)^{*}\)</td>
<td>\((3, 2)\)</td>
<td>\((3, 3)\)</td>
<td>\((3, 4)\)</td>
<td>\((3, 5)\)</td>
<td>\((3, 6)\)</td>
<td>\((3, 7)\)</td>
<td>\((3, 8)\)</td>
</tr>

<tr>
<td>\((4, 8)\)</td>
<td>\((4, 7)\)</td>
<td>\((4, 6)\)</td>
<td>\((4, 5)^{*}\)</td>
<td>\((4, 4)\)</td>
<td>\((4, 3)\)</td>
<td>\((4, 2)\)</td>
<td>\((4, 1)\)</td>
</tr>

<tr>
<td>\((5, 1)^{*}\)</td>
<td>\((5, 2)\)</td>
<td>\((5, 3)\)</td>
<td>\((5, 4)\)</td>
<td>\((5, 5)\)</td>
<td>\((5, 6)\)</td>
<td>\((5, 7)\)</td>
<td>\((5, 8)\)</td>
</tr>
</tbody>
</table>

<p>\(^{*}\) Indicates labels which must be hashed for column commitments but need not be opened for label checks.</p>

<p>Define \(C_{p_{even}}\) to be the column containing the even expander parents.</p>

<p>Define \(C_{p_{odd}}\) to be the column containing the odd expander parents.</p></li>

<li><p>Odd Partition</p>

<table>
<thead>
<tr>
<th>Even Expander Parents</th>
<th><code>~~~~</code></th>
<th>DRG Parents</th>
<th>Odd Expander Parents</th>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th>Challenges</th>
<th><code>~~~~</code></th>
</tr>
</thead>

<tbody>
<tr>
<td>\((1, 1)^{*}\)</td>
<td>\((1, 2)\)</td>
<td>\((1, 3)\)</td>
<td>\((1, 4)^{*}\)</td>
<td>\((1, 5)\)</td>
<td>\((1, 6)\)</td>
<td>\((1, 7)\)</td>
<td>\((1, 8)\)</td>
</tr>

<tr>
<td>\((3, 1)^{*}\)</td>
<td>\((3, 2)\)</td>
<td>\((3, 3)\)</td>
<td>\((3, 4)\)</td>
<td>\((3, 5)\)</td>
<td>\((3, 6)\)</td>
<td>\((3, 7)\)</td>
<td>\((3, 8)\)</td>
</tr>

<tr>
<td>\((5, 1)^{*}\)</td>
<td>\((5, 2)\)</td>
<td>\((5, 3)\)</td>
<td>\((5, 4)\)</td>
<td>\((5, 5)\)</td>
<td>\((5, 6)\)</td>
<td>\((5, 7)\)</td>
<td>\((5, 8)\)</td>
</tr>
</tbody>
</table>

<p>Concatenate and hash rows of column \(i\) to construct \(O_i\).</p>

<p>Odd column hash \(O_i = H(e_i^{(1)} || e_i^{(3)} || ‚Ä¶ || e_i^{(L-1)})\).</p>

<p>Define \(O_{p_{odd}}\) to be the odd column hash containing the odd expander parents.</p>

<p>Define \(O_{p_{even}}\) to be the odd column hash containing the even expander parents.</p></li>

<li><p>Even Partition</p>

<table>
<thead>
<tr>
<th>Even Expander Parents</th>
<th><code>~~~~</code></th>
<th>DRG Parents</th>
<th>Odd Expander Parents</th>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th>Challenges</th>
<th><code>~~~~</code></th>
</tr>
</thead>

<tbody>
<tr>
<td>\((2, 8)\)</td>
<td>\((2, 7)\)</td>
<td>\((2, 6)\)</td>
<td>\((2, 5)^{*}\)</td>
<td>\((2, 4)\)</td>
<td>\((2, 3)\)</td>
<td>\((2, 2)\)</td>
<td>\((2, 1)\)</td>
</tr>

<tr>
<td>\((4, 8)\)</td>
<td>\((4, 7)\)</td>
<td>\((4, 6)\)</td>
<td>\((4, 5)^{*}\)</td>
<td>\((4, 4)\)</td>
<td>\((4, 3)\)</td>
<td>\((4, 2)\)</td>
<td>\((4, 1)\)</td>
</tr>
</tbody>
</table>

<p>Concatenate and hash rows of column \(i\) to construct \(E_i\).</p>

<p>Remember that column with index \(i\) contains even-layered labels of index \(\bar{i} = N - i + 1\).</p>

<p>Even column hash \(E_i = H(e_{\bar{i}}^{(2)} || e_{\bar{i}}^{(4)} || ‚Ä¶ || e_{\bar{i}}^{(L-2)})\).</p>

<p>Define \(E_{p_{odd}}\) to be the even column hash containing the odd expander parents.</p>

<p>Define \(E_{p_{even}}\) to be the even column hash containing the even expander parents.</p></li>

<li><p>Vector Commitment</p>

<p>Produce the column leaves: \(C_i = H(O_i || E_i)\).</p>

<p>Generate Merkle tree for column leaves:</p>

<p>\(Comm_C = VC(C_1 || C_2 || ‚Ä¶ || C_N)\).</p></li>

<li><p>Opening</p>

<ul>
<li><p>To open only odd-layer labels</p>

<p>Reveal all odd-layer labels and prove they hash to \(O_i\): \(L / 2 - 1\) hash proofs.
Reveal the \(E_i\) (\(0\) hash proofs).</p>

<p>Note: odd-layer labels of \(C_i\) have index \(i\).</p></li>

<li><p>To open only even layer labels</p>

<p>Reveal all even layer labels and prove they hash to \(E_i\): \(L / 2 - 2\) hash proofs.
Reveal the \(O_i\) (\(0\) hash proofs).</p>

<p>Note: even-layer labels of \(C_i\) have index \(N-i+1\).</p></li>

<li><p>To open all labels</p>

<p>Reveal all labels and prove they hash to \(E_i\) and \(O_i\) as above. (\(L\) hash proofs).</p></li>

<li><p>Then, in every case</p>

<ul>
<li>Prove \(H(O_i || E_i) \rightarrow Comm_C\).</li>
<li>Reveal \(Comm_{R_{LAST}}\) and prove that \(H(Comm_C || Comm_{R_{LAST}}) = Comm_R\).</li>
</ul></li>
</ul></li>
</ul>

<h3 id="final-replica-layer">Final Replica Layer</h3>

<table>
<thead>
<tr>
<th><code>~~~~</code></th>
<th>Even Challenge</th>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th><code>~~~~</code></th>
<th>Even DRG Parent</th>
<th><code>~~~~</code></th>
<th>Even Expander Parent</th>
</tr>
</thead>

<tbody>
<tr>
<td>\((6, 1)\)</td>
<td>\((6, 2)\)</td>
<td>\((6, 3)\)</td>
<td>\((6, 4)\)</td>
<td>\((6, 5)\)</td>
<td>\((6, 6)\)</td>
<td>\((6, 7)\)</td>
<td>\((6, 8)\)</td>
</tr>
</tbody>
</table>

<ul>
<li><p>Vector Commitment</p>

<p>Generate Merkle tree for replica leaves.</p>

<p>\(R_{LAST_i} = e_i^{(L)}\).</p>

<p>\(Comm_{R_{LAST}} = VC(R_{LAST_1} || R_{LAST_2} || ‚Ä¶ || R_{LAST_N})\).</p></li>

<li><p>Opening</p>

<p>To open \(R_{LAST_i}\),</p>

<ul>
<li>Provide a merkle proof \(R_{LAST_i} \rightarrow Comm_{R_{LAST}}\).</li>
<li>Reveal \(Comm_C\) and prove that \(H(Comm_C || Comm_{R_{LAST}}) = Comm_R\).</li>
</ul></li>
</ul>

<h3 id="replica-commitment">Replica Commitment</h3>

<p>Produce \(Comm_R\) from its constituents.</p>

<p>\(Comm_R = H(Comm_C || Comm_{R_{LAST}})\).</p>

<h2 id="challenge-selection">Challenge Selection</h2>

<p>In order to minimize openings, we alternate challenged labels per layer.</p>

<p>By convention, if the challenge is \(\chi\), we challenge \(e_{\chi}^{(l_{odd})}\) and \(e_{\bar{\chi}}^{(l_{even})}\), where
\(l_{odd}\) are the odd layers and \(l_{even}\) are the even layers.</p>

<h2 id="opening-commitments-for-offline-proof">Opening Commitments for Offline Proof</h2>

<p>For use in all challenge proofs, reveal \(Comm_C\) and \(Comm_{R_{LAST}}\) and prove that \(H(Comm_C || Comm_{R_{LAST}}) =
Comm_R\).</p>

<p>To prove encoding for a challenged label \(\chi\) on odd layers \(l_{odd}\) and \(\bar{\chi}\) on even layers \(l_{even}\).</p>

<ul>
<li>Remember that \(\bar{\chi} = (N-\chi)+1\).</li>
<li>Initial data layer openings

<ul>
<li>Open label for challenged data node \(e_\chi^{(0)} ‚Äî using Comm_D\).</li>
</ul></li>
<li>ZigZag replica column openings

<ul>
<li>Open all labels in \(C_\chi\) containing challenged label&rsquo;s &lsquo;replica node&rsquo;, (\(C_\chi\)) ‚Äî using \(Comm_C\).</li>
<li>Open all labels in the &lsquo;renumbered&rsquo; column (\(C_{\bar{\chi}}\)) ‚Äî using \(Comm_C\). These are the challenged label&rsquo;s
&lsquo;data nodes&rsquo; (from the preceding layer).</li>
<li>Open all labels in the columns containing challenged label&rsquo;s DRG parents ‚Äî using \(Comm_C\).</li>
<li>Open only even-layer labels in the columns containing challenged label&rsquo;s even expander parents ‚Äî using \(Comm_C\) and
\(O_{p_{even}}\).</li>
<li>Open only odd-layer labels in the columns containing challenged label&rsquo;s odd-layer expander parents ‚Äî using \(Comm_C\)
and \(E_{p_{odd}}\).</li>
</ul></li>
<li>Final replica layer openings

<ul>
<li>Open all challenged labels (\(e_{\bar{\chi}}^{(L)}\)) and even challenged parents (any kind) ‚Äî using \(Comm_{R_{LAST}}\).</li>
</ul></li>
<li>Prove encoding as usual for all odd-layer \(e{_\chi}^{(l_{odd})}\) and even-layer \(e{_{\bar{\chi}}}^{(l_{even})}\).</li>
</ul>

<h2 id="opening-commitments-for-online-proof">Opening Commitments for Online Proof</h2>

<p>To prove encoding for a challenged label \(C\) in the replica:</p>

<ul>
<li>Reveal \(Comm_C\) (which must have been stored along with the replica).</li>
<li>Open \(Comm_{R_{LAST}}\) from provided \(Comm_R\) by proving that \(H(Comm_C || Comm_{R_{LAST}}) = Comm_R\).</li>
<li>Provide a merkle proof \(e_C^{(L)} \rightarrow Comm_{R_{LAST}}\).</li>
</ul>

</article>

      

      
    </div>

    
  

  <aside class="book-toc level-6 fixed">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#graph">Graph</a>
<ul>
<li><a href="#legend">Legend</a></li>
<li><a href="#data-layer--comm-d--tree">Data Layer: \(Comm_D\) Tree</a></li>
<li><a href="#replica-column-layers--comm-c--tree">Replica Column Layers: \(Comm_C\) Tree</a></li>
<li><a href="#final-layer--comm-r-last--tree">Final Layer: \(Comm_{R_{LAST}}\) Tree</a></li>
</ul></li>
<li><a href="#commitment-algorithm">Commitment Algorithm</a>
<ul>
<li><a href="#goal">Goal</a></li>
<li><a href="#definitions-and-notation">Definitions and Notation</a></li>
<li><a href="#initial-data-layer">Initial Data Layer</a></li>
<li><a href="#zigzag-replica-columns">ZigZag Replica Columns</a></li>
<li><a href="#final-replica-layer">Final Replica Layer</a></li>
<li><a href="#replica-commitment">Replica Commitment</a></li>
</ul></li>
<li><a href="#challenge-selection">Challenge Selection</a></li>
<li><a href="#opening-commitments-for-offline-proof">Opening Commitments for Offline Proof</a></li>
<li><a href="#opening-commitments-for-online-proof">Opening Commitments for Online Proof</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
</body>

</html>
